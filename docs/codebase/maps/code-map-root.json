{
  "version": "1.0",
  "generated": "2026-02-05",
  "rootDirectory": "G:/repos/agent",
  "commitHash": "a742664",
  "projects": {
    "Agent": {
      "path": "Agent/Agent.csproj",
      "type": "web",
      "targetFramework": "net10.0",
      "dependencies": ["Infrastructure"],
      "files": {
        "Program.cs": {
          "symbols": [
            {"name": "WebApplication", "kind": "class", "line": 6}
          ],
          "purpose": "Application entry point, DI composition root"
        },
        "Hubs/ChatHub.cs": {
          "symbols": [
            {"name": "ChatHub", "kind": "class", "line": 15, "signature": "ChatHub(IAgentFactory, IOptionsMonitor<AgentRegistryOptions>, IThreadStateStore, WebChatMessengerClient, ChatThreadResolver, INotifier)"},
            {"name": "RegisterUser", "kind": "method", "line": 32, "signature": "Task RegisterUser(string userId)"},
            {"name": "GetAgents", "kind": "method", "line": 43, "signature": "IReadOnlyList<AgentInfo> GetAgents()"},
            {"name": "SendMessage", "kind": "method", "line": 136, "signature": "IAsyncEnumerable<ChatStreamMessage> SendMessage(string, string, string?, CancellationToken)"},
            {"name": "ResumeStream", "kind": "method", "line": 96, "signature": "IAsyncEnumerable<ChatStreamMessage> ResumeStream(string, CancellationToken)"},
            {"name": "DeleteTopic", "kind": "method", "line": 199, "signature": "Task DeleteTopic(string, string, long, long)"},
            {"name": "RespondToApprovalAsync", "kind": "method", "line": 221, "signature": "Task<bool> RespondToApprovalAsync(string, ToolApprovalResult)"}
          ],
          "purpose": "SignalR hub for WebChat real-time communication"
        },
        "Hubs/HubNotificationAdapter.cs": {
          "symbols": [
            {"name": "HubNotificationAdapter", "kind": "class"}
          ],
          "purpose": "Adapter for hub notifications"
        },
        "App/ChatMonitoring.cs": {
          "symbols": [
            {"name": "ChatMonitoring", "kind": "class"}
          ],
          "purpose": "Background service for chat message monitoring"
        },
        "App/ScheduleMonitoring.cs": {
          "symbols": [
            {"name": "ScheduleMonitoring", "kind": "class"}
          ],
          "purpose": "Background service for scheduled task execution"
        },
        "Modules/ConfigModule.cs": {
          "symbols": [
            {"name": "ConfigModule", "kind": "class"},
            {"name": "ConfigureAgents", "kind": "method"}
          ],
          "purpose": "DI configuration and service registration"
        },
        "Modules/InjectorModule.cs": {
          "symbols": [
            {"name": "InjectorModule", "kind": "class"},
            {"name": "AddAgent", "kind": "method", "signature": "IServiceCollection AddAgent(AgentSettings)"},
            {"name": "AddChatMonitoring", "kind": "method", "signature": "IServiceCollection AddChatMonitoring(AgentSettings, CommandLineParams)"},
            {"name": "AddWebClient", "kind": "method", "signature": "IServiceCollection AddWebClient(AgentSettings)"},
            {"name": "AddServiceBusClient", "kind": "method", "signature": "IServiceCollection AddServiceBusClient(ServiceBusSettings, IReadOnlyList<AgentDefinition>)"}
          ],
          "purpose": "Dependency injection module with messaging client registration including composite and Service Bus clients"
        },
        "Modules/SchedulingModule.cs": {
          "symbols": [
            {"name": "SchedulingModule", "kind": "class"}
          ],
          "purpose": "Scheduling services configuration"
        },
        "Settings/AgentSettings.cs": {
          "symbols": [
            {"name": "AgentSettings", "kind": "class"}
          ],
          "purpose": "Agent configuration settings"
        },
        "Settings/CommandLineParams.cs": {
          "symbols": [
            {"name": "CommandLineParams", "kind": "class"},
            {"name": "ChatInterface", "kind": "enum"}
          ],
          "purpose": "CLI argument parsing"
        },
        "Settings/ServiceBusSettings.cs": {
          "symbols": [
            {"name": "ServiceBusSettings", "kind": "class"}
          ],
          "purpose": "Azure Service Bus configuration"
        }
      }
    },
    "Domain": {
      "path": "Domain/Domain.csproj",
      "type": "library",
      "targetFramework": "net10.0",
      "dependencies": [],
      "files": {
        "Contracts/IAgentFactory.cs": {
          "symbols": [
            {"name": "IAgentFactory", "kind": "interface", "signature": "DisposableAgent Create(AgentKey, string, string?)"}
          ],
          "purpose": "Agent creation contract"
        },
        "Contracts/IChatMessengerClient.cs": {
          "symbols": [
            {"name": "IChatMessengerClient", "kind": "interface", "line": 7},
            {"name": "SupportsScheduledNotifications", "kind": "property", "signature": "bool SupportsScheduledNotifications"},
            {"name": "Source", "kind": "property", "signature": "MessageSource Source"},
            {"name": "ReadPrompts", "kind": "method", "signature": "IAsyncEnumerable<ChatPrompt> ReadPrompts(int, CancellationToken)"},
            {"name": "ProcessResponseStreamAsync", "kind": "method", "signature": "Task ProcessResponseStreamAsync(IAsyncEnumerable<(AgentKey, AgentResponseUpdate, AiResponse?, MessageSource)>, CancellationToken)"},
            {"name": "DoesThreadExist", "kind": "method", "signature": "Task<bool> DoesThreadExist(long, long, string?, CancellationToken)"},
            {"name": "CreateTopicIfNeededAsync", "kind": "method", "signature": "Task<AgentKey> CreateTopicIfNeededAsync(MessageSource, long?, long?, string?, string?, string?, CancellationToken)"},
            {"name": "StartScheduledStreamAsync", "kind": "method", "signature": "Task StartScheduledStreamAsync(AgentKey, MessageSource, CancellationToken)"}
          ],
          "purpose": "Chat messenger client contract with message source routing and topic management"
        },
        "Contracts/IMessageSourceRouter.cs": {
          "symbols": [
            {"name": "IMessageSourceRouter", "kind": "interface", "line": 5},
            {"name": "GetClientsForSource", "kind": "method", "signature": "IEnumerable<IChatMessengerClient> GetClientsForSource(IReadOnlyList<IChatMessengerClient>, MessageSource)"}
          ],
          "purpose": "Routes messages to appropriate messenger clients based on message source"
        },
        "Contracts/IMemoryStore.cs": {
          "symbols": [
            {"name": "IMemoryStore", "kind": "interface", "line": 5},
            {"name": "StoreAsync", "kind": "method", "signature": "Task<MemoryEntry> StoreAsync(MemoryEntry, CancellationToken)"},
            {"name": "SearchAsync", "kind": "method", "signature": "Task<IReadOnlyList<MemorySearchResult>> SearchAsync(string, string?, float[]?, IEnumerable<MemoryCategory>?, IEnumerable<string>?, double?, int, CancellationToken)"},
            {"name": "MemorySearchResult", "kind": "record"},
            {"name": "MemoryStats", "kind": "record"}
          ],
          "purpose": "Vector memory storage contract"
        },
        "Contracts/IToolApprovalHandler.cs": {
          "symbols": [
            {"name": "IToolApprovalHandler", "kind": "interface"}
          ],
          "purpose": "User approval for tool execution"
        },
        "Contracts/IThreadStateStore.cs": {
          "symbols": [
            {"name": "IThreadStateStore", "kind": "interface"}
          ],
          "purpose": "Chat thread state persistence"
        },
        "Contracts/IDownloadClient.cs": {
          "symbols": [
            {"name": "IDownloadClient", "kind": "interface"}
          ],
          "purpose": "File download client contract"
        },
        "Contracts/ISearchClient.cs": {
          "symbols": [
            {"name": "ISearchClient", "kind": "interface"}
          ],
          "purpose": "Search client contract"
        },
        "Contracts/IWebBrowser.cs": {
          "symbols": [
            {"name": "IWebBrowser", "kind": "interface"}
          ],
          "purpose": "Browser automation contract"
        },
        "Contracts/INotifier.cs": {
          "symbols": [
            {"name": "INotifier", "kind": "interface"}
          ],
          "purpose": "Notification sending contract"
        },
        "Contracts/IScheduleStore.cs": {
          "symbols": [
            {"name": "IScheduleStore", "kind": "interface"}
          ],
          "purpose": "Schedule persistence contract"
        },
        "DTOs/AgentDefinition.cs": {
          "symbols": [
            {"name": "AgentDefinition", "kind": "record", "line": 6, "signature": "record AgentDefinition { Id, Name, Description?, Model, McpServerEndpoints[], WhitelistPatterns[], CustomInstructions?, TelegramBotToken?, EnabledFeatures[] }"}
          ],
          "purpose": "Agent configuration model"
        },
        "DTOs/Memory.cs": {
          "symbols": [
            {"name": "MemoryEntry", "kind": "record"},
            {"name": "MemoryCategory", "kind": "enum"},
            {"name": "MemorySource", "kind": "record"}
          ],
          "purpose": "Memory storage DTOs"
        },
        "DTOs/Schedule.cs": {
          "symbols": [
            {"name": "Schedule", "kind": "record"}
          ],
          "purpose": "Scheduled task model"
        },
        "DTOs/ToolApprovalRequest.cs": {
          "symbols": [
            {"name": "ToolApprovalRequest", "kind": "record"}
          ],
          "purpose": "Tool approval request model"
        },
        "DTOs/MessageSource.cs": {
          "symbols": [
            {"name": "MessageSource", "kind": "enum", "line": 6, "signature": "enum MessageSource { WebUi, ServiceBus, Telegram, Cli }"}
          ],
          "purpose": "Identifies the origin of a chat message for routing"
        },
        "DTOs/ParseResult.cs": {
          "symbols": [
            {"name": "ParseResult", "kind": "record", "line": 3},
            {"name": "ParseSuccess", "kind": "record", "signature": "ParseSuccess(ParsedServiceBusMessage Message)"},
            {"name": "ParseFailure", "kind": "record", "signature": "ParseFailure(string Reason, string Details)"}
          ],
          "purpose": "Discriminated union for Service Bus message parsing outcomes"
        },
        "DTOs/ParsedServiceBusMessage.cs": {
          "symbols": [
            {"name": "ParsedServiceBusMessage", "kind": "record", "signature": "record ParsedServiceBusMessage(string CorrelationId, string AgentId, string Prompt, string Sender)"}
          ],
          "purpose": "Parsed and validated Service Bus prompt message"
        },
        "DTOs/ServiceBusPromptMessage.cs": {
          "symbols": [
            {"name": "ServiceBusPromptMessage", "kind": "record", "line": 7}
          ],
          "purpose": "JSON-serializable Service Bus incoming prompt message"
        },
        "DTOs/ServiceBusResponseMessage.cs": {
          "symbols": [
            {"name": "ServiceBusResponseMessage", "kind": "record", "line": 7}
          ],
          "purpose": "JSON-serializable Service Bus outgoing response message"
        },
        "DTOs/WebChat/ChatStreamMessage.cs": {
          "symbols": [
            {"name": "ChatStreamMessage", "kind": "record"}
          ],
          "purpose": "Streaming message for WebChat"
        },
        "DTOs/WebChat/TopicMetadata.cs": {
          "symbols": [
            {"name": "TopicMetadata", "kind": "record"}
          ],
          "purpose": "Chat topic metadata"
        },
        "Agents/AgentKey.cs": {
          "symbols": [
            {"name": "AgentKey", "kind": "record", "signature": "record AgentKey(long ChatId, long ThreadId, string? AgentId)"}
          ],
          "purpose": "Unique agent session identifier"
        },
        "Agents/ChatThreadContext.cs": {
          "symbols": [
            {"name": "ChatThreadContext", "kind": "class"}
          ],
          "purpose": "Thread context management"
        },
        "Agents/ChatThreadResolver.cs": {
          "symbols": [
            {"name": "ChatThreadResolver", "kind": "class"}
          ],
          "purpose": "Thread ID resolution"
        },
        "Agents/DisposableAgent.cs": {
          "symbols": [
            {"name": "DisposableAgent", "kind": "class"}
          ],
          "purpose": "Base disposable agent class"
        },
        "Monitor/ChatMonitor.cs": {
          "symbols": [
            {"name": "ChatMonitor", "kind": "class", "line": 13, "signature": "ChatMonitor(IChatMessengerClient, IAgentFactory, ChatThreadResolver, ILogger<ChatMonitor>)"},
            {"name": "Monitor", "kind": "method", "signature": "Task Monitor(CancellationToken)"}
          ],
          "purpose": "Reads prompts from messenger client, groups by thread, and processes through agent pipeline"
        },
        "Monitor/ScheduleExecutor.cs": {
          "symbols": [
            {"name": "ScheduleExecutor", "kind": "class", "line": 14, "signature": "ScheduleExecutor(IScheduleStore, IScheduleAgentFactory, IChatMessengerClient, Channel<Schedule>, ILogger<ScheduleExecutor>)"},
            {"name": "ProcessSchedulesAsync", "kind": "method", "signature": "Task ProcessSchedulesAsync(CancellationToken)"}
          ],
          "purpose": "Processes scheduled tasks by creating agents and routing responses through messenger client"
        },
        "Routers/MessageSourceRouter.cs": {
          "symbols": [
            {"name": "MessageSourceRouter", "kind": "class", "line": 6, "signature": "MessageSourceRouter : IMessageSourceRouter"},
            {"name": "GetClientsForSource", "kind": "method", "signature": "IEnumerable<IChatMessengerClient> GetClientsForSource(IReadOnlyList<IChatMessengerClient>, MessageSource)"}
          ],
          "purpose": "Routes messages to WebUI client plus source-matching client"
        },
        "Tools/Downloads/FileDownloadTool.cs": {
          "symbols": [
            {"name": "FileDownloadTool", "kind": "class"}
          ],
          "purpose": "File download business logic"
        },
        "Tools/Memory/MemoryStoreTool.cs": {
          "symbols": [
            {"name": "MemoryStoreTool", "kind": "class"}
          ],
          "purpose": "Memory storage tool"
        },
        "Tools/Memory/MemoryRecallTool.cs": {
          "symbols": [
            {"name": "MemoryRecallTool", "kind": "class"}
          ],
          "purpose": "Memory recall/search tool"
        },
        "Tools/Scheduling/ScheduleCreateTool.cs": {
          "symbols": [
            {"name": "ScheduleCreateTool", "kind": "class"}
          ],
          "purpose": "Schedule creation tool"
        },
        "Tools/Web/WebBrowseTool.cs": {
          "symbols": [
            {"name": "WebBrowseTool", "kind": "class"}
          ],
          "purpose": "Web browsing tool"
        },
        "Tools/Text/TextCreateTool.cs": {
          "symbols": [
            {"name": "TextCreateTool", "kind": "class"}
          ],
          "purpose": "Text file creation tool"
        },
        "Prompts/BasePrompt.cs": {
          "symbols": [
            {"name": "BasePrompt", "kind": "class"}
          ],
          "purpose": "Base system prompts"
        }
      }
    },
    "Infrastructure": {
      "path": "Infrastructure/Infrastructure.csproj",
      "type": "library",
      "targetFramework": "net10.0",
      "dependencies": ["Domain"],
      "files": {
        "Agents/MultiAgentFactory.cs": {
          "symbols": [
            {"name": "MultiAgentFactory", "kind": "class", "line": 11, "signature": "MultiAgentFactory(IServiceProvider, IOptionsMonitor<AgentRegistryOptions>, OpenRouterConfig, IDomainToolRegistry)"},
            {"name": "Create", "kind": "method", "signature": "DisposableAgent Create(AgentKey, string, string?)"},
            {"name": "CreateFromDefinition", "kind": "method", "signature": "DisposableAgent CreateFromDefinition(AgentKey, string, AgentDefinition)"},
            {"name": "GetAvailableAgents", "kind": "method", "signature": "IReadOnlyList<AgentInfo> GetAvailableAgents()"},
            {"name": "OpenRouterConfig", "kind": "record"},
            {"name": "AgentRegistryOptions", "kind": "class"}
          ],
          "purpose": "Multi-agent creation and routing factory"
        },
        "Agents/McpAgent.cs": {
          "symbols": [
            {"name": "McpAgent", "kind": "class", "line": 15, "signature": "McpAgent(string[], IChatClient, string, string, IThreadStateStore, string, string?, IReadOnlyList<AIFunction>?)"},
            {"name": "RunCoreAsync", "kind": "method", "signature": "Task<AgentResponse> RunCoreAsync(IEnumerable<ChatMessage>, AgentSession?, AgentRunOptions?, CancellationToken)"},
            {"name": "RunCoreStreamingAsync", "kind": "method", "signature": "IAsyncEnumerable<AgentResponseUpdate> RunCoreStreamingAsync(...)"}
          ],
          "purpose": "MCP-integrated AI agent implementation"
        },
        "Agents/ThreadSession.cs": {
          "symbols": [
            {"name": "ThreadSession", "kind": "class"}
          ],
          "purpose": "Thread session management"
        },
        "Agents/Mcp/McpClientManager.cs": {
          "symbols": [
            {"name": "McpClientManager", "kind": "class", "line": 9},
            {"name": "CreateAsync", "kind": "method", "signature": "Task<McpClientManager> CreateAsync(string, string, string, string[], McpClientHandlers, CancellationToken)"},
            {"name": "Clients", "kind": "property", "signature": "IReadOnlyList<McpClient> Clients"},
            {"name": "Tools", "kind": "property", "signature": "IReadOnlyList<AITool> Tools"},
            {"name": "Prompts", "kind": "property", "signature": "IReadOnlyList<string> Prompts"}
          ],
          "purpose": "MCP client connection management"
        },
        "Agents/Mcp/McpResourceManager.cs": {
          "symbols": [
            {"name": "McpResourceManager", "kind": "class"}
          ],
          "purpose": "MCP resource subscription management"
        },
        "Agents/Mcp/McpSubscriptionManager.cs": {
          "symbols": [
            {"name": "McpSubscriptionManager", "kind": "class"}
          ],
          "purpose": "MCP subscription lifecycle"
        },
        "Agents/Mcp/McpSamplingHandler.cs": {
          "symbols": [
            {"name": "McpSamplingHandler", "kind": "class"}
          ],
          "purpose": "MCP sampling request handler"
        },
        "Agents/ChatClients/OpenRouterChatClient.cs": {
          "symbols": [
            {"name": "OpenRouterChatClient", "kind": "class"}
          ],
          "purpose": "OpenRouter LLM client"
        },
        "Agents/ChatClients/ToolApprovalChatClient.cs": {
          "symbols": [
            {"name": "ToolApprovalChatClient", "kind": "class"}
          ],
          "purpose": "Chat client with tool approval wrapper"
        },
        "Agents/ChatClients/RedisChatMessageStore.cs": {
          "symbols": [
            {"name": "RedisChatMessageStore", "kind": "class"}
          ],
          "purpose": "Redis-backed chat history"
        },
        "Memory/RedisStackMemoryStore.cs": {
          "symbols": [
            {"name": "RedisStackMemoryStore", "kind": "class", "line": 12, "signature": "RedisStackMemoryStore(IConnectionMultiplexer)"},
            {"name": "StoreAsync", "kind": "method"},
            {"name": "SearchAsync", "kind": "method"},
            {"name": "VectorSearchAsync", "kind": "method"}
          ],
          "purpose": "Redis Stack vector memory store implementation"
        },
        "Memory/OpenRouterEmbeddingService.cs": {
          "symbols": [
            {"name": "OpenRouterEmbeddingService", "kind": "class"}
          ],
          "purpose": "Embedding generation via OpenRouter"
        },
        "StateManagers/RedisThreadStateStore.cs": {
          "symbols": [
            {"name": "RedisThreadStateStore", "kind": "class"}
          ],
          "purpose": "Redis thread state persistence"
        },
        "StateManagers/RedisScheduleStore.cs": {
          "symbols": [
            {"name": "RedisScheduleStore", "kind": "class"}
          ],
          "purpose": "Redis schedule persistence"
        },
        "Clients/Messaging/CompositeChatMessengerClient.cs": {
          "symbols": [
            {"name": "CompositeChatMessengerClient", "kind": "class", "line": 10, "signature": "CompositeChatMessengerClient(IReadOnlyList<IChatMessengerClient>, IMessageSourceRouter)"},
            {"name": "ReadPrompts", "kind": "method", "signature": "IAsyncEnumerable<ChatPrompt> ReadPrompts(int, CancellationToken)"},
            {"name": "ProcessResponseStreamAsync", "kind": "method", "signature": "Task ProcessResponseStreamAsync(IAsyncEnumerable<...>, CancellationToken)"},
            {"name": "CreateTopicIfNeededAsync", "kind": "method", "signature": "Task<AgentKey> CreateTopicIfNeededAsync(MessageSource, long?, long?, string?, string?, string?, CancellationToken)"}
          ],
          "purpose": "Composite messenger client that multiplexes prompts from and routes responses to multiple underlying clients"
        },
        "Clients/Messaging/Telegram/TelegramChatClient.cs": {
          "symbols": [
            {"name": "TelegramChatClient", "kind": "class", "line": 16, "signature": "TelegramChatClient(IEnumerable<(string, string)>, string[], bool, ILogger<TelegramChatClient>, string?)"},
            {"name": "ReadPrompts", "kind": "method", "signature": "IAsyncEnumerable<ChatPrompt> ReadPrompts(int, CancellationToken)"},
            {"name": "ProcessResponseStreamAsync", "kind": "method"},
            {"name": "CreateTopicIfNeededAsync", "kind": "method"}
          ],
          "purpose": "Telegram bot message client"
        },
        "Clients/Messaging/WebChat/WebChatMessengerClient.cs": {
          "symbols": [
            {"name": "WebChatMessengerClient", "kind": "class", "line": 16, "signature": "WebChatMessengerClient(WebChatSessionManager, WebChatStreamManager, WebChatApprovalManager, ChatThreadResolver, IThreadStateStore, INotifier, ILogger<WebChatMessengerClient>)"},
            {"name": "ReadPrompts", "kind": "method"},
            {"name": "ProcessResponseStreamAsync", "kind": "method"},
            {"name": "CreateTopicIfNeededAsync", "kind": "method"},
            {"name": "EnqueuePromptAndGetResponses", "kind": "method", "signature": "IAsyncEnumerable<ChatStreamMessage> EnqueuePromptAndGetResponses(string, string, string, string?, CancellationToken)"}
          ],
          "purpose": "WebChat messaging client with SignalR streaming and session management"
        },
        "Clients/Messaging/ServiceBus/ServiceBusChatMessengerClient.cs": {
          "symbols": [
            {"name": "ServiceBusChatMessengerClient", "kind": "class", "line": 8, "signature": "ServiceBusChatMessengerClient(ServiceBusPromptReceiver, ServiceBusResponseHandler)"},
            {"name": "ReadPrompts", "kind": "method", "signature": "IAsyncEnumerable<ChatPrompt> ReadPrompts(int, CancellationToken)"},
            {"name": "ProcessResponseStreamAsync", "kind": "method"}
          ],
          "purpose": "Azure Service Bus messaging client for external system integration"
        },
        "Clients/Messaging/ServiceBus/ServiceBusProcessorHost.cs": {
          "symbols": [
            {"name": "ServiceBusProcessorHost", "kind": "class", "line": 8, "signature": "ServiceBusProcessorHost(ServiceBusProcessor, ServiceBusMessageParser, ServiceBusPromptReceiver, ILogger<ServiceBusProcessorHost>) : BackgroundService"},
            {"name": "ExecuteAsync", "kind": "method", "signature": "Task ExecuteAsync(CancellationToken)"},
            {"name": "ProcessMessageAsync", "kind": "method"},
            {"name": "ProcessErrorAsync", "kind": "method"}
          ],
          "purpose": "Background service that receives Service Bus messages, parses them, and enqueues valid prompts"
        },
        "Clients/Messaging/ServiceBus/ServiceBusMessageParser.cs": {
          "symbols": [
            {"name": "ServiceBusMessageParser", "kind": "class", "line": 7, "signature": "ServiceBusMessageParser(IReadOnlyList<string> validAgentIds)"},
            {"name": "Parse", "kind": "method", "signature": "ParseResult Parse(ServiceBusReceivedMessage)"}
          ],
          "purpose": "Parses and validates Service Bus messages with strict field and agent validation"
        },
        "Clients/Messaging/ServiceBus/ServiceBusPromptReceiver.cs": {
          "symbols": [
            {"name": "ServiceBusPromptReceiver", "kind": "class", "line": 10, "signature": "ServiceBusPromptReceiver(ServiceBusConversationMapper, INotifier, ILogger<ServiceBusPromptReceiver>)"},
            {"name": "ReadPromptsAsync", "kind": "method", "signature": "IAsyncEnumerable<ChatPrompt> ReadPromptsAsync(CancellationToken)"},
            {"name": "EnqueueAsync", "kind": "method", "signature": "Task EnqueueAsync(ParsedServiceBusMessage, CancellationToken)"},
            {"name": "TryGetCorrelationId", "kind": "method", "signature": "virtual bool TryGetCorrelationId(long chatId, out string correlationId)"}
          ],
          "purpose": "Receives prompts from Service Bus, maps correlationId via conversation mapper, notifies WebUI, and queues to channel"
        },
        "Clients/Messaging/ServiceBus/ServiceBusResponseHandler.cs": {
          "symbols": [
            {"name": "ServiceBusResponseHandler", "kind": "class", "line": 7, "signature": "ServiceBusResponseHandler(ServiceBusPromptReceiver, ServiceBusResponseWriter)"},
            {"name": "ProcessAsync", "kind": "method"}
          ],
          "purpose": "Handles agent response streaming and writes completed responses to Service Bus response queue"
        },
        "Clients/Messaging/ServiceBus/ServiceBusResponseWriter.cs": {
          "symbols": [
            {"name": "ServiceBusResponseWriter", "kind": "class", "line": 10, "signature": "ServiceBusResponseWriter(ServiceBusSender, ILogger<ServiceBusResponseWriter>)"},
            {"name": "WriteResponseAsync", "kind": "method", "signature": "virtual Task WriteResponseAsync(string correlationId, string agentId, string response, CancellationToken)"}
          ],
          "purpose": "Writes responses to Service Bus with Polly exponential backoff retry resilience"
        },
        "Clients/Messaging/ServiceBus/ServiceBusConversationMapper.cs": {
          "symbols": [
            {"name": "ServiceBusConversationMapper", "kind": "class", "line": 11, "signature": "ServiceBusConversationMapper(IConnectionMultiplexer, IThreadStateStore, ILogger<ServiceBusConversationMapper>)"},
            {"name": "GetOrCreateMappingAsync", "kind": "method", "signature": "Task<(long ChatId, long ThreadId, string TopicId, bool IsNew)> GetOrCreateMappingAsync(string correlationId, string agentId, CancellationToken)"},
            {"name": "TryGetCorrelationId", "kind": "method", "signature": "bool TryGetCorrelationId(long chatId, out string correlationId)"}
          ],
          "purpose": "Maps Service Bus correlationId to internal chatId/threadId with Redis persistence and in-memory reverse lookup"
        },
        "Clients/Messaging/Cli/CliChatMessengerClient.cs": {
          "symbols": [
            {"name": "CliChatMessengerClient", "kind": "class", "line": 12, "signature": "CliChatMessengerClient(ICliChatMessageRouter, Action?, IThreadStateStore?)"},
            {"name": "ReadPrompts", "kind": "method"},
            {"name": "ProcessResponseStreamAsync", "kind": "method"},
            {"name": "CreateTopicIfNeededAsync", "kind": "method"}
          ],
          "purpose": "CLI chat client with history restoration"
        },
        "Clients/Messaging/Cli/OneShotChatMessengerClient.cs": {
          "symbols": [
            {"name": "OneShotChatMessengerClient", "kind": "class", "line": 11, "signature": "OneShotChatMessengerClient(string, bool, IHostApplicationLifetime)"},
            {"name": "ReadPrompts", "kind": "method"},
            {"name": "ProcessResponseStreamAsync", "kind": "method"}
          ],
          "purpose": "Single-prompt CLI client that sends one message and exits"
        },
        "Clients/Browser/PlaywrightWebBrowser.cs": {
          "symbols": [
            {"name": "PlaywrightWebBrowser", "kind": "class"}
          ],
          "purpose": "Playwright browser automation"
        },
        "Clients/Torrent/QBittorrentDownloadClient.cs": {
          "symbols": [
            {"name": "QBittorrentDownloadClient", "kind": "class"}
          ],
          "purpose": "qBittorrent download client"
        },
        "Clients/Torrent/JackettSearchClient.cs": {
          "symbols": [
            {"name": "JackettSearchClient", "kind": "class"}
          ],
          "purpose": "Jackett torrent search client"
        },
        "Clients/BraveSearchClient.cs": {
          "symbols": [
            {"name": "BraveSearchClient", "kind": "class"}
          ],
          "purpose": "Brave Search API client"
        },
        "Clients/IdealistaClient.cs": {
          "symbols": [
            {"name": "IdealistaClient", "kind": "class"}
          ],
          "purpose": "Idealista real estate API client"
        },
        "Clients/ToolApproval/TelegramToolApprovalHandler.cs": {
          "symbols": [
            {"name": "TelegramToolApprovalHandler", "kind": "class"}
          ],
          "purpose": "Telegram tool approval UI"
        },
        "Clients/ToolApproval/WebToolApprovalHandler.cs": {
          "symbols": [
            {"name": "WebToolApprovalHandler", "kind": "class"}
          ],
          "purpose": "WebChat tool approval handler"
        },
        "CliGui/Ui/TerminalGuiAdapter.cs": {
          "symbols": [
            {"name": "TerminalGuiAdapter", "kind": "class"}
          ],
          "purpose": "Terminal.Gui UI adapter"
        },
        "Utils/ToolPatternMatcher.cs": {
          "symbols": [
            {"name": "ToolPatternMatcher", "kind": "class"}
          ],
          "purpose": "Tool whitelist pattern matching"
        }
      }
    },
    "McpServerLibrary": {
      "path": "McpServerLibrary/McpServerLibrary.csproj",
      "type": "console",
      "targetFramework": "net10.0",
      "dependencies": ["Infrastructure"],
      "files": {
        "Program.cs": {"purpose": "MCP server entry point"},
        "McpTools/McpFileDownloadTool.cs": {
          "symbols": [{"name": "McpFileDownloadTool", "kind": "class"}],
          "purpose": "MCP wrapper for file download"
        },
        "McpTools/McpFileSearchTool.cs": {
          "symbols": [{"name": "McpFileSearchTool", "kind": "class"}],
          "purpose": "MCP wrapper for file search"
        },
        "McpTools/McpContentRecommendationTool.cs": {
          "symbols": [{"name": "McpContentRecommendationTool", "kind": "class"}],
          "purpose": "MCP wrapper for content recommendation"
        },
        "McpResources/McpDownloadResource.cs": {
          "symbols": [{"name": "McpDownloadResource", "kind": "class"}],
          "purpose": "MCP resource for downloads"
        },
        "ResourceSubscriptions/SubscriptionTracker.cs": {
          "symbols": [{"name": "SubscriptionTracker", "kind": "class"}],
          "purpose": "Resource subscription tracking"
        }
      }
    },
    "McpServerText": {
      "path": "McpServerText/McpServerText.csproj",
      "type": "console",
      "targetFramework": "net10.0",
      "dependencies": ["Infrastructure"],
      "files": {
        "McpTools/McpTextCreateTool.cs": {"purpose": "Text file creation"},
        "McpTools/McpTextReadTool.cs": {"purpose": "Text file reading"},
        "McpTools/McpTextEditTool.cs": {"purpose": "Text file editing"},
        "McpTools/McpTextSearchTool.cs": {"purpose": "Text search"}
      }
    },
    "McpServerWebSearch": {
      "path": "McpServerWebSearch/McpServerWebSearch.csproj",
      "type": "console",
      "targetFramework": "net10.0",
      "dependencies": ["Infrastructure"],
      "files": {
        "McpTools/McpWebSearchTool.cs": {"purpose": "Web search tool"},
        "McpTools/McpWebBrowseTool.cs": {"purpose": "Web browsing tool"},
        "McpTools/McpWebClickTool.cs": {"purpose": "Web click interaction"},
        "McpTools/McpWebInspectTool.cs": {"purpose": "Web page inspection"}
      }
    },
    "McpServerMemory": {
      "path": "McpServerMemory/McpServerMemory.csproj",
      "type": "console",
      "targetFramework": "net10.0",
      "dependencies": ["Infrastructure"],
      "files": {
        "McpTools/McpMemoryStoreTool.cs": {"purpose": "Memory storage"},
        "McpTools/McpMemoryRecallTool.cs": {"purpose": "Memory recall"},
        "McpTools/McpMemoryForgetTool.cs": {"purpose": "Memory deletion"},
        "McpTools/McpMemoryListTool.cs": {"purpose": "Memory listing"},
        "McpTools/McpMemoryReflectTool.cs": {"purpose": "Memory reflection"}
      }
    },
    "McpServerIdealista": {
      "path": "McpServerIdealista/McpServerIdealista.csproj",
      "type": "console",
      "targetFramework": "net10.0",
      "dependencies": ["Infrastructure"],
      "files": {
        "McpTools/McpPropertySearchTool.cs": {"purpose": "Real estate property search"}
      }
    },
    "McpServerCommandRunner": {
      "path": "McpServerCommandRunner/McpServerCommandRunner.csproj",
      "type": "console",
      "targetFramework": "net10.0",
      "dependencies": ["Infrastructure"],
      "files": {
        "Program.cs": {"purpose": "Command runner MCP server"}
      }
    },
    "WebChat": {
      "path": "WebChat/WebChat.csproj",
      "type": "web",
      "targetFramework": "net10.0",
      "dependencies": ["WebChat.Client"],
      "files": {
        "Program.cs": {"purpose": "Blazor WebAssembly host"}
      }
    },
    "WebChat.Client": {
      "path": "WebChat.Client/WebChat.Client.csproj",
      "type": "blazorwasm",
      "targetFramework": "net10.0",
      "dependencies": [],
      "files": {
        "State/Store.cs": {
          "symbols": [
            {"name": "Store<TState>", "kind": "class", "signature": "Store<TState>(TState)"},
            {"name": "State", "kind": "property"},
            {"name": "StateObservable", "kind": "property"},
            {"name": "Dispatch", "kind": "method"}
          ],
          "purpose": "Redux-like state container"
        },
        "State/Connection/ConnectionStore.cs": {"purpose": "Connection state management"},
        "State/Messages/MessagesStore.cs": {"purpose": "Messages state management"},
        "State/Messages/MessagesReducers.cs": {
          "symbols": [
            {"name": "MessagesReducers", "kind": "class"},
            {"name": "Reduce", "kind": "method", "signature": "MessagesState Reduce(MessagesState, IAction)"}
          ],
          "purpose": "Immutable state reducers for messages with deduplication and finalization tracking"
        },
        "State/Topics/TopicsStore.cs": {"purpose": "Topics state management"},
        "State/Streaming/StreamingStore.cs": {"purpose": "Streaming state management"},
        "State/Approval/ApprovalStore.cs": {"purpose": "Tool approval state"},
        "State/Hub/HubEventDispatcher.cs": {"purpose": "SignalR event dispatching"},
        "State/Effects/AgentSelectionEffect.cs": {
          "symbols": [
            {"name": "AgentSelectionEffect", "kind": "class"}
          ],
          "purpose": "Side effect that reloads topics and history when agent selection changes"
        },
        "State/Effects/TopicDeleteEffect.cs": {
          "symbols": [
            {"name": "TopicDeleteEffect", "kind": "class"},
            {"name": "HandleRemoveTopic", "kind": "method"}
          ],
          "purpose": "Side effect that handles topic deletion including stream cancellation and pipeline cleanup"
        },
        "State/Pipeline/IMessagePipeline.cs": {
          "symbols": [
            {"name": "IMessagePipeline", "kind": "interface"},
            {"name": "SubmitUserMessage", "kind": "method", "signature": "string SubmitUserMessage(string, string, string?)"},
            {"name": "AccumulateChunk", "kind": "method"},
            {"name": "FinalizeMessage", "kind": "method"},
            {"name": "ClearTopic", "kind": "method", "signature": "void ClearTopic(string topicId)"},
            {"name": "WasSentByThisClient", "kind": "method", "signature": "bool WasSentByThisClient(string? correlationId)"}
          ],
          "purpose": "Contract for WebChat message processing pipeline with dedup and correlation tracking"
        },
        "State/Pipeline/MessagePipeline.cs": {
          "symbols": [
            {"name": "MessagePipeline", "kind": "class", "line": 9, "signature": "MessagePipeline(IDispatcher, MessagesStore, StreamingStore, ILogger<MessagePipeline>)"},
            {"name": "SubmitUserMessage", "kind": "method"},
            {"name": "AccumulateChunk", "kind": "method"},
            {"name": "FinalizeMessage", "kind": "method"},
            {"name": "ClearTopic", "kind": "method"},
            {"name": "WasSentByThisClient", "kind": "method"}
          ],
          "purpose": "WebChat message pipeline implementation with finalization dedup and correlation tracking"
        },
        "Services/StreamingService.cs": {"purpose": "Stream management service"},
        "Services/ChatConnectionService.cs": {"purpose": "Chat connection service"}
      }
    },
    "Tests": {
      "path": "Tests/Tests.csproj",
      "type": "test",
      "targetFramework": "net10.0",
      "dependencies": ["Agent", "Infrastructure", "McpServerLibrary", "McpServerMemory", "McpServerWebSearch", "WebChat.Client"],
      "testFramework": "xunit",
      "files": {
        "Integration/Agents/McpAgentIntegrationTests.cs": {"purpose": "MCP agent integration tests"},
        "Integration/Clients/TelegramBotChatMessengerClientTests.cs": {"purpose": "Telegram bot messenger client integration tests"},
        "Integration/Memory/RedisMemoryStoreTests.cs": {"purpose": "Redis memory store tests"},
        "Integration/WebChat/ChatHubIntegrationTests.cs": {"purpose": "SignalR hub tests"},
        "Integration/Fixtures/ServiceBusFixture.cs": {"purpose": "Service Bus test fixture with correlationId-based message helpers"},
        "Integration/Messaging/ServiceBusIntegrationTests.cs": {"purpose": "Service Bus end-to-end integration tests"},
        "Unit/Domain/ScheduleCreateToolTests.cs": {"purpose": "Schedule tool unit tests"},
        "Unit/Domain/MonitorTests.cs": {"purpose": "ChatMonitor unit tests"},
        "Unit/Infrastructure/Messaging/CompositeChatMessengerClientTests.cs": {"purpose": "Composite messenger client unit tests"},
        "Unit/Infrastructure/Messaging/ServiceBusMessageParserTests.cs": {"purpose": "Service Bus message parsing and validation tests"},
        "Unit/Infrastructure/Messaging/ServiceBusPromptReceiverTests.cs": {"purpose": "Service Bus prompt receiver tests"},
        "Unit/Infrastructure/Messaging/ServiceBusResponseHandlerTests.cs": {"purpose": "Service Bus response handler tests"},
        "Unit/Infrastructure/Messaging/ServiceBusResponseWriterTests.cs": {"purpose": "Service Bus response writer tests"},
        "Unit/Infrastructure/Messaging/ServiceBusChatMessengerClientTests.cs": {"purpose": "Service Bus messenger client tests"},
        "Unit/Infrastructure/Messaging/ServiceBusSourceMapperTests.cs": {"purpose": "Service Bus conversation mapper tests"},
        "Unit/Infrastructure/Messaging/WebChatMessengerClientTests.cs": {"purpose": "WebChat messenger client unit tests"},
        "Unit/Infrastructure/ToolPatternMatcherTests.cs": {"purpose": "Tool pattern matching tests"},
        "Unit/WebChat.Client/State/MessagesStoreTests.cs": {"purpose": "Messages store unit tests"},
        "Unit/WebChat.Client/State/Pipeline/MessagePipelineTests.cs": {"purpose": "Message pipeline unit tests"},
        "Unit/WebChat.Client/State/TopicDeleteEffectTests.cs": {"purpose": "Topic delete effect unit tests"}
      }
    }
  },
  "statistics": {
    "projects": 12,
    "sourceFiles": 194,
    "testFiles": 99,
    "contracts": 21,
    "dtos": 31,
    "tools": 35,
    "mcpServers": 6
  }
}
