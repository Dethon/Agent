@page "/"
@page "/{Slug}"
@inherits StoreSubscriberComponent
@inject IDispatcher Dispatcher

<ApprovalModal />

<div class="chat-layout">
    <TopicList />

    <div class="chat-container">
        <MessageList />

        <ConnectionStatus />

        <div class="input-area">
            <ChatInput />
        </div>
    </div>
</div>

@code {
    [Parameter]
    public string? Slug { get; set; }

    protected override void OnInitialized()
    {
        var slug = string.IsNullOrEmpty(Slug) ? "default" : Slug;
        Dispatcher.Dispatch(new SelectSpace(slug));
        Dispatcher.Dispatch(new Initialize());
    }

    protected override void OnParametersSet()
    {
        var slug = string.IsNullOrEmpty(Slug) ? "default" : Slug;
        Dispatcher.Dispatch(new SelectSpace(slug));
    }
}
