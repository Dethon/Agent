name: jackbot
services:
  qbittorrent:
    image: qbittorrentofficial/qbittorrent-nox:5.1.2-2
    container_name: qbittorrent
    ports:
      - "8001:8001"
      - "6881:6881/tcp"
      - "6881:6881/udp"
    volumes:
      - ./volumes/qbittorrent_config:/config
      - ${DATA_PATH:-./volumes/data}/downloads:/downloads
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - QBT_LEGAL_NOTICE=confirm
      - QBT_VERSION=5.1.2-2
      - QBT_TORRENTING_PORT=6881
      - QBT_WEBUI_PORT=8001
      - TZ=UTC
      - UMASK=002
    stop_grace_period: 30m
    restart: unless-stopped
    networks:
      - jackbot

  filebrowser:
    image: filebrowser/filebrowser:v2
    container_name: filebrowser
    ports:
      - "8002:80"
    volumes:
      - ${DATA_PATH:-./volumes/data}:/srv
      - ./volumes/filebrowser_database:/database
      - ./volumes/filebrowser_config:/config
    restart: unless-stopped
    networks:
      - jackbot

  jackett:
    image: lscr.io/linuxserver/jackett:0.22.2207
    container_name: jackett
    ports:
      - "8003:9117"
    volumes:
      - ./volumes/jackett_config:/config
      - ./volumes/jackett_data/downloads:/downloads
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=UTC
      - UMASK=022
    restart: unless-stopped
    depends_on:
      - flaresolverr
    networks:
      - jackbot
        
  flaresolverr:
    image: ghcr.io/flaresolverr/flaresolverr:latest
    container_name: flaresolverr
    environment:
      - LOG_LEVEL=info
      - LOG_HTML=false
      - CAPTCHA_SOLVER=none
      - TZ=UTC
    ports:
      - "8191:8191"
    networks:
      - jackbot
    restart: unless-stopped

  plex:
    image: lscr.io/linuxserver/plex:1.41.9
    container_name: plex
    network_mode: host
    devices:
      - dev/dri:/dev/dri
    volumes:
      - ./volumes/plex_config:/config
      - ${DATA_PATH:-./volumes/data}:/media
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=UTC
      - VERSION=docker
    restart: unless-stopped
    
  mcp-download:
    image: mcp-download:latest
    container_name: mcp-download
    ports:
      - "6001:8080"
    build:
      context: ${JACK_REPOSITORY_PATH}
      dockerfile: McpServer.Download/Dockerfile
    restart: unless-stopped
    env_file:
      - .env
    networks:
      - jackbot
    depends_on:
      - qbittorrent
      - jackett
  
  mcp-organize:
    image: mcp-organize:latest
    container_name: mcp-organize
    ports:
      - "6001:8080"
    build:
      context: ${JACK_REPOSITORY_PATH}
      dockerfile: McpServer.Organize/Dockerfile
    user: ${PUID:-1654}:${PGID:-1654}
    volumes:
      - ${DATA_PATH:-./volumes/data}/downloads:/downloads
      - ${DATA_PATH:-./volumes/data}:/media
    restart: unless-stopped
    env_file:
      - .env
    networks:
      - jackbot
        
  jack:
    image: agent:latest
    container_name: jack
    build:
      context: ${JACK_REPOSITORY_PATH}
      dockerfile: Agent/Dockerfile
    restart: unless-stopped
    env_file:
      - .env
    networks:
      - jackbot
    depends_on:
      - mcp-download
      - mcp-organize

networks:
  jackbot:
