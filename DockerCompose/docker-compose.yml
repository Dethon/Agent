name: jackbot
services:
  qbittorrent:
    image: qbittorrentofficial/qbittorrent-nox:5.1.2-2
    container_name: qbittorrent
    ports:
      - "8001:8001"
      - "6881:6881/tcp"
      - "6881:6881/udp"
    volumes:
      - ./volumes/qbittorrent_config:/config
      - ${DATA_PATH:-./volumes/data}/downloads:/downloads
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - QBT_LEGAL_NOTICE=confirm
      - QBT_VERSION=5.1.2-2
      - QBT_TORRENTING_PORT=6881
      - QBT_WEBUI_PORT=8001
      - TZ=UTC
      - UMASK=002
    stop_grace_period: 30m
    restart: unless-stopped
    networks:
      - jackbot

  filebrowser:
    image: filebrowser/filebrowser:v2
    container_name: filebrowser
    ports:
      - "8002:80"
    volumes:
      - ${DATA_PATH:-./volumes/data}:/srv
      - ./volumes/filebrowser_database:/database
      - ./volumes/filebrowser_config:/config
    restart: unless-stopped
    networks:
      - jackbot

  jackett:
    image: lscr.io/linuxserver/jackett:0.22.2207
    container_name: jackett
    ports:
      - "8003:9117"
    volumes:
      - ./volumes/jackett_config:/config
      - ./volumes/jackett_data/downloads:/downloads
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=UTC
      - UMASK=022
    restart: unless-stopped
    networks:
      - jackbot

  plex:
    image: lscr.io/linuxserver/plex:1.41.9
    container_name: plex
    network_mode: host
    devices:
      - dev/dri:/dev/dri
    volumes:
      - ./volumes/plex_config:/config
      - ${DATA_PATH:-./volumes/data}:/media
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=UTC
      - VERSION=docker
    restart: unless-stopped

  jack:
    image: agent:latest
    container_name: jack
    user: ${PUID:-1654}:${PGID:-1654}
    volumes:
      - ${DATA_PATH:-./volumes/data}/downloads:/downloads
      - ${DATA_PATH:-./volumes/data}:/media
    build:
      context: ${JACK_REPOSITORY_PATH}
      dockerfile: Agent/Dockerfile
    restart: unless-stopped
    env_file:
      - .env
    networks:
      - jackbot

networks:
  jackbot:
